<!-- Info text of sequence area -->
<div class="qpisql-info-area help-block">
  {QUESTION_TEXT}
</div>

<!-- Sequence input -->
<div class="qpisql-input-area">

  <!-- Sequence A is given -->
  <input type="hidden" name="sequence_a" id="qpisql-sequence-a" value="{SEQUENCE_A}" />

  <div class="help-block">
    <b>{YOUR_SEQUENCE}</b>
  </div>
  <!-- Sequence B input -->
  <textarea id="qpisql-sequence-b" name="sequence_b" data-contains-code class="qpisql-code-input-box" cols="80" rows="10">{SEQUENCE_B}</textarea>
  <script>
    // Create a coding box out of the textarea
    var editor_sequence_b = CodeMirror.fromTextArea(document.getElementById('qpisql-sequence-b'), {
      lineNumbers: true,
      mode: 'text/x-sql'
    });

    // Insert a onChange handler (all results have reset)
    editor_sequence_b.on('change',function(){
      {PAGEHANDLER}.deleteOldOutputs();
    })
  </script>

  <!-- Sequence C is given -->
  <input type="hidden" name="sequence_c" id="qpisql-sequence-c" value="{SEQUENCE_C}" />

  <!-- Integrity check is given -->
  <input type="hidden" name="integrity_check" id="qpisql-integrity-check" value="{INTEGRITY_CHECK}" />

</div>


<!--
  Hidden fields for saving the state of the execution
  If executed_bool is false (no executing until now) or error_bool is true (error was found)
  it is not allowed to submit the form (respectively the submission is not accepted)
-->
<div class="qpisql-hidden-fields">

  <input type="hidden" name="error_bool" id="qpisql-error-bool" value="{ERROR_BOOL}" />
  <input type="hidden" name="executed_bool" id="qpisql-executed-bool" value="{EXECUTED_BOOL}" />
  <input type="hidden" name="output_relation" id="qpisql-output-relation" value="{OUTPUT_RELATION}" />

</div>

<!-- Output area -->
<div class="qpisql-output-area">

  <div id="qpisql-output-area-error" class="qpisql-inner-output-area" style="display:none">
  </div>
  <div id="qpisql-output-area-execution-running" class="qpisql-inner-output-area" style="display:none">
    {STATUS_EXECUTION_RUNNING}
  </div>
  <div id="qpisql-output-area-relation" class="qpisql-inner-output-area" style="display:none">
  </div>

  <script>
    // Insert the different error messages we might need later on
    const error_no_execution = "{ERROR_NO_EXECUTION}";
    const error_db_creation = "{ERROR_DB_CREATION}";
    const error_integrity_check = "{ERROR_INTEGRITY_CHECK}";
    const error_no_visible_result = "{ERROR_NO_VISIBLE_RESULT}";
    const error_running_sequence = "{ERROR_RUNNING_SEQUENCE}";

    // Use the values of the hidden fields to dynamicly generate values of the visible area
    const default_error_bool = document.getElementById("qpisql-error-bool").value;
    const default_executed_bool = document.getElementById("qpisql-executed-bool").value;
    const default_output_relation = document.getElementById("qpisql-output-relation").value;

    // In every case that we do not have a valid ouput relation by default,
    // we have to output an error that a execution is necessary
    if(default_error_bool == "true" ||
       default_executed_bool == "false" ||
       default_output_relation == "")
    {
      {PAGEHANDLER}.outputError(new sqlRunErrorNoExecution());
    }
    // Otherwise we can display a result
    else
    {
      try
      {
        {PAGEHANDLER}.outputResult(new sqlResult(JSON.parse(default_output_relation)));
      }
      catch (err)
      {
        {PAGEHANDLER}.outputError(new sqlRunErrorNoExecution());
      }
    }
  </script>

</div>

<div class="qpisql-execute-button-area">
  <input type="button" class="btn-default btn-sm btn" id="qpisql-execute-button" value="Execute" onclick="{PAGEHANDLER}.execute()">
</div>
